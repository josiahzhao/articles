---
title: 一文带你了解什么是CDN
categories:
- 开发手册
tags:
- 网络
date: 2021-12-30 00:46:25
---

# 一文带你了解什么是CDN

CDN是content delivery network或者是content distribution network的缩写
即内容分发网络。

## 背景说明

从1991年开始，随着互联网技术的发展和网民的增加，给网络带来越来越多的压力，在传输效率上逐渐出现了瓶颈。

给我们带来直接的困扰就是，明明我们使用了4G，5G网络，家里安装了百兆，千兆宽带，但是看视频，浏览网页，听音乐，还是慢，为什么？

这里列举两个典型的场景，和开车一样，距离和拥堵程度共同影响了访问效率。

### 距离问题

假如我们从北京访问美国的一个网站或者视频，美国和中国的直线距离是10000公里，网络光缆传输接近光速，大约是30万公里/s，传输时延就是330ms，一个来回就是660ms，但这只是理想情况，假设真的从美国到北京直接拉了一条长约10000公里的光缆，全程高速公路，没有堵车，没有收费站。

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/65B21362-3E95-47FF-8466-D6BC43A65AE8.png)

但实际情况，光缆传输速度是光速的2/3左右。
![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/3C139FC7-9606-4345-9848-D48A28577433.png)

以及美国到北京中间并不是一根光缆，而是有无数的小网组成，比如国内三大运营商，比如你家里使用的二级，三级网络运营商；这些小网络之间的传输就好比独木桥或者收费站，要做计费处理，会有拥堵，会有抖动，远不及光速。

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/F27BA3AA-E566-444D-A394-949D6BFA5BF8.png)

这样算下来，不要说从美国到北京，就是从广州到北京，直接访问一些视频资源，直播资源，网页资源，很容易让你感到卡顿。

除了距离的问题，还有带宽的问题。

### 带宽问题

1个人浏览1080P的视频，需要视频服务器能够提供4Mbps的带宽（就是我们说的购买的百兆带宽，千兆带宽的兆），比如有10000个人要访问一个1080P的视频，那么视频服务器就需要40000Mbps（40Gbps）；一张网卡能够提供的带宽是多少？普通一些的1000兆，一张网卡能够供250个人同事浏览，10000个人就需要40张网卡，不太准确但也差不多的说法，40台服务器，如果是一亿人呢，400,000台。

所以，如果视频源头没有大量服务器对网络带宽的支撑，纵使家里的买了再好的宽带，1000个人争抢只能给10个人用的资源，怎么也快不起来.

这两个场景，就好比开车，传输距离和拥堵情况程度共同决定了你的网络访问效率.

CDN就是专门解决这个问题的。

## 起源

说到CDN的起源，就要提到3个人和一个公司。

### 1995年

1995年初由MIT麻省理工学院的万维网发明家蒂姆·伯纳斯·李（Tim Berners-Lee）预见到了这种拥挤，他说“不久之后，所有网络用户都会感受到网络拥挤的问题”。

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/EE7087B8-7C92-4F76-97CB-918B21B71AD3.png)


所以他向自己在MIT的同事，应用数学教授汤姆·莱顿（Tom Leighton）提出了这个技术挑战，虽然汤姆·莱顿是应用数学的教授，但是他曾是MIT计算机科学实验室算法组的负责人，是并行算法和体系结构方面的著名专家。莱顿教授认识到可以在应用数学和算法中找到解决网络拥塞的方法，因此他组建了一个研究小组来解决该问题。

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/943F61DD-3DE0-45A2-B178-1E23CD40A45E.png)

### 1996年

丹尼尔·莱文（Danny Lewin）于Technion获得计算机科学和数学学士学位后，于同年秋天加入MIT，加入莱顿教授成立的研究小组，由于他的加入，在CDN技术上取得了各种快速且重要的进步。

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/C35B75E8-1B55-4F3F-B399-6DA49312EC95.png)

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/03E0A2C2-BC73-43D7-B04A-FE3959D0588B.png)


### 1997年

接下来莱顿教授和丹尼尔·莱文（Danny Lewin）一起探索CDN的可能的商业价值，并于1998年共同成立公司：阿卡迈公司（Akamai）（市值百亿美元）。

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/6514A5B5-E614-4F22-A0EF-D0E0B1F70B19.png)

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/8891EB41-9D26-4449-8309-0463A898BAF2.png)

## CDN的原理
![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/53248773-BBB2-4BBF-B4AA-CECF794083B0.png)

利用物理上的多台服务器，将用户需要的音乐、图片、视频、应用程序等资源分布式存储在全球各地，这样用户便可以高效、稳定的就近获取需要资源。

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/30A9C4C0-F8D0-4FE9-88DD-FE6C31CADBE8.png)

拿大家熟悉的物流来举例，在美国如果需要买中国京东的商品，往往大部分的商品都已经运输到当地的物流仓库中，当收到订单时，边可以从最近的物流仓库发货，保障物流效率。

对应的CDN技术，商品就是我们需要的音乐、图片、视频资源，京东就是资源提供商比如QQ音乐、YouTube视频，仓库就是CDN节点，就近派发就是CDN的负载均衡策略。

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/E05B2E8A-7EB2-45FD-9F5A-D7512B13E583.png)


## CDN盈利模式

中小型公司不像BAT，一般是没有能力搭建遍布各地的机房提供CDN服务的，但是他们又需要把自己的内容发布给终端用户，因此他们就需要购买CDN服务，固定月租，或者按流量付费。

不同的CDN厂商价格不同，收费模式不同，优惠力度不同，覆盖率不同，速率不同，企业根据实际选择。

这些厂商背后，还是基于三大运营商来，在三大运营商的网络基础能力之上进行封装，提供CDN服务。

所以我们用户看视频，视频提供商提供视频，双方都需要给运营商交钱。

用户缴纳网络流量、带宽服务等费用，内容提供商额外提供CDN服务的租赁费用。

![](https://nginx.mostintelligentape.com/blogimg/202112/CDN/387E1B96-8A49-4D59-84EF-67002C704090.png)

为什么运营商自己不提供CDN服务呢？有机会我们后面可以专门整理一个专题。


## CDN的问题

既然流量和费用挂钩，那安全性、攻击防御就一直是CDN的老大难问题，如果安全不到位，很可能一波攻击就把所有的流量额度用完了，并且都是无效流量。

另一方面也是安全，是内容的安全，还拿物流举例，如果一批商品已经传输到全球的物流仓库中，突然发现这批商品有问题需要紧急召回，就会麻烦一些，从全球各地的物流仓库中进行清理，甚至可能还会触犯当地法律，扣下商品激进型审核。

对比到CDN，一个全球级别内容传输网络，如果里面有违法的，敏感的内容，后果将不堪设想，所以在内容发布前期有一系列的备案保障发布商的内容质量；确保内容发布后有对应的措施和预案来紧急下线各个CDN节点中有问题的内容，但是这个是有延迟的，很可能发现的时候已经晚了，下线稍微有个1分钟的延迟，影响就已经十分大了。


